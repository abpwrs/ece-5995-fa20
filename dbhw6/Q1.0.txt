:auto USING PERIODIC COMMIT 500
LOAD    CSV WITH HEADERS FROM "file:///ml-latest-small/movies.csv"  AS row
MERGE   (m:Movie  {movieId: toInteger(row.movieId), title: row.title})
WITH    m, row
UNWIND  split(row.genres, '|')  AS genres
MERGE   (g:Genre {name: genres})
MERGE   (m)-[r:IN_GENRE]->(g);